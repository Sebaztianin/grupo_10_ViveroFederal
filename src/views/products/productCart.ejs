<!DOCTYPE html>
<html>

<head>
    <%- include('../partials/head.ejs') %>
    <title>Vivero Federal: Carrito</title>
    <link rel="stylesheet" href="/css/products/productCart.css">
</head>

<body>

    <%- include('../partials/header.ejs') %>

    <main>

        <form class="cart" action="#" method="GET">

            <section class="products">

                <!-- Título -->
                <h3 class="section-title">Carrito de compras</h3>

                <!-- Listado -->
                <div class="products-list">

                    <% let subtotal = 0; %>
                    <% for (i = 0; i < cartItems.length; i++) { %>
                        <% subtotal = subtotal + (cartItems[i].product.price * cartItems[i].quantity); %>

                    <article>
                        <img src="/images/products/<%= cartItems[i].product.image %>" alt="Imagen del producto" class="product_img">
                        <div class="article">
                            <a href="/products/detail/<%= cartItems[i].product.id %>">
                                <p class="name"><%= cartItems[i].product.name %></p>
                            </a>
                            <div class="article-details">
                                <div class="quantity">
                                    <input class="quantity-input" type="number" name="quantity" id="quantity" value="<%= cartItems[i].quantity %>">
                                </div>
                                <div class="total">
                                    <p class="price">$ <%= toThousand(cartItems[i].product.price) %></p>
                                    <button type="button" name="delete"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </article>

                    <% } %>

                </div>

            </section>

            <!-- Calcular envío -->
            <section class="delivery">
                <label id="cp">Envío: </label>
                <input class="cp" type="number" name="cp" id="cp" placeholder="Código postal">
                <button type="menu" name="calculate">Calcular</button>
            </section>

            <!-- Subtotal -->
            <section class="subtotal">
                <p class="title">Subtotal: </p>
                <p class="value">$ <%= toThousand(subtotal) %></p>
            </section>

            <!-- Botón -->
            <section class="submit">
                <button type="submit" name="buy">Comprar</button>
                <a href="/products">Ver más productos</a>
            </section>

        </form>

    </main>

    <%- include('../partials/footer.ejs') %>

</body>

</html>